language: minimal
sudo: true
dist: xenial

env:
  global:
    - LC_ALL: C.UTF-8
    - LANG: C.UTF-8
    - SNAPCRAFT_ENABLE_SILENT_REPORT: y
    - SNAPCRAFT_ENABLE_DEVELOPER_DEBUG: y

script:
- sudo apt-get update
- sudo apt-get --yes install snapd
- sudo snap install lxd
- sudo snap install snapcraft --classic
- sudo /snap/bin/lxd.migrate -yes
- sudo /snap/bin/lxd waitready
- sudo /snap/bin/lxd init --auto
- mkdir -p "$TRAVIS_BUILD_DIR/snaps-cache"
- sudo snapcraft --use-lxd

deploy:
  provider: snap
  snap: cjp256-ant-hello-world*.snap
  channel: edge
  skip_cleanup: true
